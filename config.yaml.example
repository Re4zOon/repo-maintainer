# GitLab Stale Branch/Merge Request Notifier Configuration
# Copy this file to config.local.yaml and fill in your values

# GitLab connection settings
gitlab:
  url: "https://gitlab.example.com"
  private_token: "your-gitlab-private-token"

# Project IDs to check for stale branches
# IMPORTANT: Only the repositories listed here will be scanned.
# This script does NOT scan all repositories in your GitLab instance.
# You must explicitly list each project ID you want to monitor.
#
# To find a project's ID:
# - In GitLab UI: Go to project page â†’ "Project overview" or "Settings > General"
# - Via API: GET /api/v4/projects?search=project-name
projects:
  - 123
  - 456
  - 789

# Number of days after which a branch is considered stale
stale_days: 30

# Number of weeks until automatic cleanup/archiving
# After a branch/MR has been stale for stale_days + (cleanup_weeks * 7) days,
# it becomes eligible for automatic archiving (if enabled)
cleanup_weeks: 4

# Notification frequency (in days)
# Controls how often the same recipient receives notifications:
# - If a person got an email about branch A on monday and we find a new stale
#   branch/MR on wednesday, we send both on wednesday (new item triggers email)
# - Otherwise, we only send once per notification_frequency_days period
# Default: 7 (once per week)
notification_frequency_days: 7

# Path to SQLite database for tracking notification history
# This database stores when each recipient was last notified about each item
# to prevent sending duplicate notifications too frequently
# Default: ./notification_history.db
database_path: "./notification_history.db"

# Fallback email address for:
# - Inactive users (committers whose GitLab accounts are inactive)
# - Merge requests where assignee/author email cannot be determined
# Notifications will be sent here as a fallback
fallback_email: "repo-maintainers@example.com"

# SMTP server settings for sending emails
smtp:
  host: "smtp.example.com"
  port: 587
  use_tls: true
  username: "notifications@example.com"
  password: "your-smtp-password"
  from_email: "GitLab Maintenance <notifications@example.com>"

# =============================================================================
# Automatic Archiving Settings
# =============================================================================
# Automatic archiving safely cleans up very old stale branches and MRs by:
# 1. Exporting the branch to a local archive folder (as a compressed tar.gz)
# 2. Closing any associated merge requests (with a note explaining the closure)
# 3. Deleting the source branch
#
# A branch/MR is eligible for archiving when it has been stale for:
#   stale_days + (cleanup_weeks * 7) days
# (With the default settings: 30 + 28 = 58 days)

# Enable automatic archiving (default: false)
# When enabled via config, archiving runs automatically with notifications.
# Can also be enabled per-run with the --archive command-line flag.
enable_auto_archive: false

# Local folder to store archived branches
# Each archived branch is saved as: {project_name}_{branch_name}_{timestamp}.tar.gz
# Default: ./archived_branches
archive_folder: "./archived_branches"

# =============================================================================
# MR Reminder Comments Settings
# =============================================================================
# When enabled, the bot will post friendly reminder comments directly on stale
# merge requests for increased visibility. This is in addition to email
# notifications and does not affect archiving behavior.
#
# Comments are posted when:
# 1. The MR has been inactive for at least mr_comment_inactivity_days (X days)
# 2. The bot hasn't commented on this MR in the last mr_comment_frequency_days (Y days)
#
# The comments are designed to be clear and friendly (with a touch of humor)
# to encourage action without being annoying.

# Enable MR reminder comments (default: false)
enable_mr_comments: false

# Number of days of inactivity before posting the first comment (X days)
# An MR is considered inactive if there are no commits, comments, or updates
# Default: 14
mr_comment_inactivity_days: 14

# Frequency of posting new comments (Y days)
# After the first comment, a new comment will be posted every Y days
# if the MR remains inactive
# Default: 7
mr_comment_frequency_days: 7
