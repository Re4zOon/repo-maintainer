services:
  repo-maintainer:
    build: .
    container_name: repo-maintainer
    volumes:
      # Mount config file (read-only)
      - ./config.yaml:/app/config.yaml:ro
      # Mount data directory for database persistence
      - ./data:/app/data
    restart: "no"

  # WebUI service for monitoring and configuration
  repo-maintainer-webui:
    build: .
    container_name: repo-maintainer-webui
    command: ["python", "-m", "webui.app", "-c", "/app/config.yaml"]
    ports:
      - "5000:5000"
    volumes:
      # Mount config file (read-write for config updates)
      - ./config.yaml:/app/config.yaml
      # Mount data directory for database access
      - ./data:/app/data
    environment:
      - WEBUI_HOST=0.0.0.0
      - WEBUI_PORT=5000
      - CONFIG_PATH=/app/config.yaml
      # Set these for authentication (change in production!)
      - WEBUI_USERNAME=admin
      - WEBUI_PASSWORD=admin
      # Optional: Set a secure secret key
      # - WEBUI_SECRET_KEY=your-secure-secret-key
    restart: unless-stopped
